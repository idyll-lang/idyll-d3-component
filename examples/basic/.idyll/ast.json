[["meta",[["title",["value","d3 + Idyll"]],["description",["value","An introduction to using d3 and Idyll"]]],[]],["IdyllLogo",[],[]],["Header",[["title",["value","Using d3 with Idyll"]],["subtitle",["value","An introduction to using the data visualization library with Idyll"]],["author",["value","Matthew Conlen"]],["authorLink",["value","https://twitter.com/mathisonian"]]],[]],["div",[["className",["value","inset"]],["style",["expression","{maxWidth: 150, margin: '0 auto'}"]]],[["a",[["href",["value","https://bl.ocks.org/mbostock/2d466ec3417722e3568cd83fc35338e3"]]],[["CircleWave",[["style",["expression","{width: \"100%\"}"]]],[]]]]]],["p",[],["This is a guide for those who are familiar with d3 and wish to use d3 in the idiomatic way,\nas opposed to relying on React to handle DOM updates."]],["p",[],["Idyll defines a custom ",["code",[],["D3Component"]]," that you can use to create a custom d3 component.\nTo use it, create a class that extends from it, and implements two methods: ",["code",[],["initialize"]],",\nand ",["code",[],["update"]],"."]],["gist",[["gist",["value","e583bc2d6143ab867bab73701762af00"]],["file",["value","idyll-d3.jsx"]]],[]],["p",[],["and in your ",["code",[],["index.idl"]]," file, instantiate the component like this:"]],["gist",[["gist",["value","e583bc2d6143ab867bab73701762af00"]],["file",["value","d3.idl"]]],[]],["h3",[],["iniatialize(node, props)"]],["p",[],["The initialize function is called only once when your component first mounts. Use this function to\ncreate any necessary DOM elements and render your component with the initially provided properties."]],["h3",[],["update(props)"]],["p",[],["This function is called any time the props object changes. Use this function e.g. to update\nyour component when bound data changes."]],["h2",[],["Example"]],["p",[],["The circle at the top of this post is adapted\nfrom ",["link",[["text",["value","Mike Bostock's block"]],["href",["value","https://bl.ocks.org/mbostock/2d466ec3417722e3568cd83fc35338e3"]]],[]],",\nwhich was inspired by ",["link",[["text",["value","Dave Whyte's circle wave"]],["href",["value",""]]],[]],". You might be\nmore familiar with Dave Whyte's handle, ",["link",[["href",["value","https://twitter.com/beesandbombs"]],["text",["value","@beesandbombs"]]],[]],"."]],["p",[],["To use the block, I can just stick the code into the ",["code",[],["initialize"]]," function. Since this doesn't take any user\ninput or have dynamic properties, I can omit the ",["code",[],["update"]]," function altogether."]],["gist",[["gist",["value","e583bc2d6143ab867bab73701762af00"]],["file",["value","circle-wave.jsx"]]],[]],["p",[],["The only changes I've made were to make the radius of the circle dynamic, and to\ninsert an ",["code",[],["<svg>"]]," element instead of expecting one to be on the page already."]],["h2",[],["Updating props"]],["var",[["name",["value","color"]],["value",["value","#000"]]],[]],["Force",[["nodeColor",["expression","color"]]],[]],["Button",[["onClick",["expression","color === '#000' ? color = '#ff0000' : color = '#000' "]]],["\nToggle Color"]],["gist",[["gist",["value","e583bc2d6143ab867bab73701762af00"]],["file",["value","update.idl"]]],[]],["p",[],["To make this work, I've adapted code from this ",["link",[["text",["value","d3 force dragging block"]],["href",["value","https://bl.ocks.org/mbostock/ad70335eeef6d167bc36fd3c04378048"]]],[]],"\nand added a property to determine the node color. Since this example uses a draw loop to render\nto canvas, I can simply read the node color property each loop. The final piece to make it work smoothly\nis to ensure that the draw loop is triggered every time the properties update."]],["gist",[["gist",["value","e583bc2d6143ab867bab73701762af00"]],["file",["value","force.jsx"]]],[]],["p",[],["Read more about Idyll at ",["link",[["href",["value","https://idyll-lang.github.io/"]],["text",["value","https://idyll-lang.github.io/"]]],[]],",\nor ",["link",[["href",["value","https://github.com/idyll-lang/idyll-d3-component/tree/master/examples/basic"]],["text",["value","check out the source for this example"]]],[]],"."]]]